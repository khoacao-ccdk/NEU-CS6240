Strategy - Do filter before stripping the data to get required fields, then join
Filter: 
Leg 1: Only using flight with:
- Origin = ORD
- Dest != JFK
- Cancelled = 0
- Diverted = 0
- !((Year <= 2007 && Month < 6) || (Year >= 2008 && Month > 5))

Leg 2: Only using flight with:
- Origin != ORD
- Dest = JFK
- Cancelled = 0
- Diverted = 0
- !((Year <= 2007 && Month < 6) || (Year >= 2008 && Month > 5))

Getting required fields only:
Origin
Dest
FlightDate
DepTime
ArrTime
Cancelled (should not = 1)
Diverted (should not = 1)
ArrDelayMinutes (Use this field to calculate)

Join:
- Same flight date
- Leg 1's Dest == Leg 2's Origin
- Leg 1's ArrTime < Leg 2's DeptTime

Calculate:
- Sum Leg 1 and Leg 2 ArrDelayMinutes
- Calculate average 